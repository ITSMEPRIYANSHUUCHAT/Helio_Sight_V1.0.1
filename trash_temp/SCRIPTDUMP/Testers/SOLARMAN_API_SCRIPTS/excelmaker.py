import pandas as pd
import json

# JSON data (replace this with your actual JSON data or load from a file)
json_data = {
    "code": None,
    "msg": None,
    "success": True,
    "requestId": "e0f1c23977218ce0",
    "deviceSn": "SQ1021080KE22B300010",
    "deviceId": 223561340,
    "deviceType": "INVERTER",
    "timeType": 1,
    "paramDataList": [
        {
            "collectTime": "1746231760",
            "dataList": [
                {"name": "SN", "value": "SQ1021080KE22B300010", "key": "SN1"},
                {"unit": '{"1000":"String","1022":"MZ-IVH5000","1021":"MZ-IVH4600","1020":"MZ-IVH3700","1019":"Cleavage Phase","1018":"Split Phase","1017":"Three-phase grid-connected","1016":"S6Three phase HV Hybrid","1015":"Three phase HV Hybrid","1014":"Reserved","1013":"High-pressure energy storage","1012":"Low-pressure energy storage","1011":"Grid-connected machine","1010":"Three phase LV Hybrid","1008":"Single phase LV Hybrid","1007":"Solar inverter","1006":"Three-phase ","1005":"Single-phase","1027":"Knight 6000","1004":"Single-phase Grid Connected","1026":"Knight 3600","1003":"Three-phase Energy Storage","1025":"MZ-IVH5000L","1002":"Micro-inversion","1024":"MZ-IVH4600L","1001":"Single-phase Energy Storage","1023":"MZ-IVH3700L","1009":"Microinverter"}', "name": "Inverter Type", "key": "INV_MOD1"},
                {"name": "Production Compliance Country", "value": "Europe General", "key": "SS_CY1"},
                {"name": "Safety Standard", "value": "EU General", "key": "SSD"},
                {"unit": "W", "name": "Rated Power", "value": "80000", "key": "Pr1"},
                {"name": "Total Number Of BTS 5K Online", "key": "PCU_NUM"},
                {"name": "PCU_ID", "key": "PCU_ID"},
                {"unit": '{"1001":"Enable","1000":"Disable"}', "name": "Parallel Function", "key": "P_F"},
                {"name": "Local Parallel Address", "key": "L_P_A"},
                {"unit": '{"1001":"Slave","1000":"Master"}', "name": "Master-Slave", "key": "M_SLAVE"},
                {"name": "Slave Address", "value": "01", "key": "S_Adds"},
                {"name": "Afci_Srs_Hard", "key": "AF_sh"},
                {"name": "Model", "value": "80KTLX-G3", "key": "D_M"},
                {"name": "System Time", "value": "2025-05-03 05:52:22", "key": "SYSTIM1"},
                {"name": "DSPM Firmware Version", "value": "V000021", "key": "M_S_V"},
                {"name": "DSPS Firmware Version", "value": "V000021", "key": "V_S_V"},
                {"name": "Standard Main Version", "value": "0607", "key": "S_M_V"},
                {"name": "Protocol Version", "key": "PTCv1"},
                {"name": "Firmware version", "key": "FWv2"},
                {"name": "ARM Firmware Version", "value": "V000013", "key": "COMM_CPU_SWv1"},
                {"name": "PCU Software Version", "key": "PCU_S_V"},
                {"name": "AddressMask_BDU1", "key": "BDU_AM_1"},
                {"name": "AddressMask_BDU2", "key": "BDU_AM_2"},
                {"name": "BDU Software Version", "key": "BDU_S_V"},
                {"name": "Afci_Ver_Firmware", "key": "AF_VF"},
                {"name": "Afci_Ver_Sft", "key": "AF_VS"},
                {"name": "Afci_Ver_Hard", "key": "AF_VH"},
                {"name": "Afci_Ver_Com", "key": "AF_VC"},
                {"name": "Version Type", "key": "Ver_T"},
                {"unit": "V", "name": "DC Voltage PV1", "value": "552.10", "key": "DV1"},
                {"unit": "V", "name": "DC Voltage PV2", "value": "552.00", "key": "DV2"},
                {"unit": "V", "name": "DC Voltage PV3", "value": "90.70", "key": "DV3"},
                {"unit": "V", "name": "DC Voltage PV4", "value": "551.60", "key": "DV4"},
                {"unit": "V", "name": "DC Voltage PV5", "value": "552.60", "key": "DV5"},
                {"unit": "V", "name": "DC Voltage PV6", "value": "552.50", "key": "DV6"},
                {"unit": "V", "name": "DC Voltage PV7", "key": "DV7"},
                {"unit": "V", "name": "DC Voltage PV8", "key": "DV8"},
                {"unit": "V", "name": "DC Voltage PV9", "key": "DV9"},
                {"unit": "V", "name": "DC Voltage PV10", "key": "DV10"},
                {"unit": "V", "name": "DC Voltage PV11", "key": "DV11"},
                {"unit": "V", "name": "BUS Negative Ground Voltage", "key": "B_N_G_V"},
                {"unit": "V", "name": "DC Voltage PV12", "key": "DV12"},
                {"unit": "V", "name": "DC Voltage PV13", "key": "DV13"},
                {"unit": "V", "name": "DC Voltage PV14", "key": "DV14"},
                {"unit": "V", "name": "DC Voltage PV15", "key": "DV15"},
                {"unit": "V", "name": "DC Voltage PV16", "key": "DV16"},
                {"unit": "A", "name": "DC Current PV1", "value": "0.17", "key": "DC1"},
                {"unit": "A", "name": "DC Current PV2", "value": "0.29", "key": "DC2"},
                {"unit": "A", "name": "DC Current PV3", "value": "0.26", "key": "DC3"},
                {"unit": "A", "name": "DC Current PV4", "value": "0.19", "key": "DC4"},
                {"unit": "A", "name": "DC Current PV5", "value": "0.00", "key": "DC5"},
                {"unit": "A", "name": "DC Current PV6", "value": "0.52", "key": "DC6"},
                {"unit": "A", "name": "DC Current PV7", "key": "DC7"},
                {"unit": "A", "name": "DC Current PV8", "key": "DC8"},
                {"unit": "A", "name": "DC Current PV9", "key": "DC9"},
                {"unit": "A", "name": "DC Current PV10", "key": "DC10"},
                {"unit": "A", "name": "DC Current PV11", "key": "DC11"},
                {"unit": "A", "name": "DC Current PV12", "key": "DC12"},
                {"unit": "A", "name": "DC Current PV13", "key": "DC13"},
                {"unit": "A", "name": "DC Current PV14", "key": "DC14"},
                {"unit": "A", "name": "DC Current PV15", "key": "DC15"},
                {"unit": "A", "name": "DC Current PV16", "key": "DC16"},
                {"unit": "W", "name": "DC Power PV1", "value": "90.00", "key": "DP1"},
                {"unit": "W", "name": "DC Power PV2", "value": "160.00", "key": "DP2"},
                {"unit": "W", "name": "DC Power PV3", "value": "20.00", "key": "DP3"},
                {"unit": "W", "name": "DC Power PV4", "value": "100.00", "key": "DP4"},
                {"unit": "W", "name": "DC Power PV5", "value": "0.00", "key": "DP5"},
                {"unit": "W", "name": "DC Power PV6", "value": "290.00", "key": "DP6"},
                {"unit": "W", "name": "DC Power PV7", "key": "DP7"},
                {"unit": "W", "name": "DC Power PV8", "key": "DP8"},
                {"unit": "W", "name": "DC Power PV9", "key": "DP9"},
                {"unit": "W", "name": "DC Power PV10", "key": "DP10"},
                {"unit": "W", "name": "DC Power PV11", "key": "DP11"},
                {"unit": "W", "name": "DC Power PV12", "key": "DP12"},
                {"unit": "W", "name": "DC Power PV13", "key": "DP13"},
                {"unit": "W", "name": "DC Power PV14", "key": "DP14"},
                {"unit": "W", "name": "DC Power PV15", "key": "DP15"},
                {"unit": "W", "name": "DC Power PV16", "key": "DP16"},
                {"unit": "W", "name": "PV Total Power", "key": "PVTP"},
                {"unit": "W", "name": "Total Power Generation", "value": "660.0", "key": "TPG"},
                {"unit": "W", "name": "Total DC Input Power", "value": "0.00", "key": "DPi_t1"},
                {"unit": "V", "name": "AC Voltage R/U/A", "value": "265.20", "key": "AV1"},
                {"unit": "V", "name": "AC Voltage S/V/B", "value": "266.90", "key": "AV2"},
                {"unit": "V", "name": "AC Voltage T/W/C", "value": "265.30", "key": "AV3"},
                {"unit": "A", "name": "AC Current R/U/A", "value": "0.09", "key": "AC1"},
                {"unit": "A", "name": "AC Current S/V/B", "value": "0.09", "key": "AC2"},
                {"unit": "A", "name": "AC Current T/W/C", "value": "0.09", "key": "AC3"},
                {"unit": "Hz", "name": "AC Output Frequency R", "value": "50.00", "key": "A_Fo1"},
                {"unit": "W", "name": "AC Power R/U/A", "key": "AP1"},
                {"unit": "W", "name": "AC Power S/V/B", "key": "AP2"},
                {"unit": "W", "name": "AC Power T/W/C", "key": "AP3"},
                {"unit": "W", "name": "Total AC Output Power", "value": "0.00", "key": "T_AC_OP"},
                {"unit": "VA", "name": "Total AC Apparent Power", "value": "0.00", "key": "A_St1"},
                {"unit": "V", "name": "AC line voltage AB", "key": "AV_LINE1"},
                {"unit": "V", "name": "Alternating Current Voltage-BC Line", "key": "AV_LINE2"},
                {"unit": "V", "name": "Alternating Current Voltage-CA Line", "key": "AV_LINE3"},
                {"unit": "Var", "name": "Reactive Power-R phase", "key": "Q1"},
                {"unit": "Var", "name": "Reactive Power-S phase", "key": "Q2"},
                {"unit": "Var", "name": "Reactive Power-T phase", "key": "Q3"},
                {"unit": "V", "name": "Output Voltage Off-grid--R phase", "key": "Vog_o1"},
                {"unit": "V", "name": "Output Voltage Off-grid--S phase", "key": "Vog_o2"},
                {"unit": "V", "name": "Output Voltage Off-grid--T phase", "key": "Vog_o3"},
                {"name": "Power factor", "key": "P_FACT"},
                {"unit": "V", "name": "FlyingCap Voltage7", "key": "FC_V7"},
                {"unit": "kWh", "name": "Cumulative Production (Active)", "value": "319242.90", "key": "Et_ge0"},
                {"unit": "kWh", "name": "Daily Production (Active)", "value": "0", "key": "Etdy_ge1"},
                {"unit": "kWh", "name": "Monthly Production (Active)", "key": "Emon1"},
                {"unit": "kWh", "name": "Yearly Production (Active)", "key": "Eyr1"},
                {"unit": "W", "name": "ActivePower PV Ext", "key": "ACTPV"},
                {"unit": "kW", "name": "ActivePower Output L1N", "key": "AP_O_L1N"},
                {"unit": "kW", "name": "ActivePower Output L2N", "key": "AP_O_L2N"},
                {"unit": "kW", "name": "ActivePower PCC L1N", "key": "AP_PCC_L1N"},
                {"unit": "kW", "name": "ActivePower PCC L2N", "key": "AP_PCC_L2N"},
                {"unit": "W", "name": "Total Pcc Reactive Power", "key": "PCC_A_Qt1"},
                {"unit": "W", "name": "Total Pcc Apparent Power", "key": "PCC_A_St1"},
                {"unit": "A", "name": "PCC AC Current R", "value": "0.00", "key": "PCC_AC1"},
                {"unit": "A", "name": "PCC AC Current S", "value": "0.00", "key": "PCC_AC2"},
                {"unit": "A", "name": "PCC AC Current T", "value": "0.00", "key": "PCC_AC3"},
                {"unit": "W", "name": "PCC AC Power R", "key": "PCC_AP1"},
                {"unit": "W", "name": "PCC AC Power S", "key": "PCC_AP2"},
                {"unit": "W", "name": "PCC AC Power T", "key": "PCC_AP3"},
                {"unit": "Var", "name": "PCC Reactive Power R", "key": "PCC_Q1"},
                {"unit": "Var", "name": "PCC Reactive Power S", "key": "PCC_Q2"},
                {"unit": "Var", "name": "PCC Reactive Power T", "key": "PCC_Q3"},
                {"name": "PCC Power Factor R", "key": "PCC_PF1"},
                {"name": "PCC Power Factor S", "key": "PCC_PF2"},
                {"name": "PCC Power Factor T", "key": "PCC_PF3"},
                {"unit": "W", "name": "ActivePower PV Ext", "key": "AP_EX"},
                {"unit": "mA", "name": "Leak Current", "value": "0", "key": "Clk1"},
                {"unit": "KΩ", "name": "Insulation Impedance 1", "value": "0", "key": "N_Iinfo1"},
                {"name": "Grid Status", "value": "Static", "key": "ST_PG1"},
                {"unit": "V", "name": "Grid RS/UV/AB line voltage", "key": "G_AB_L_V"},
                {"unit": "V", "name": "Grid ST/VW/BC line voltage", "key": "G_BC_L_V"},
                {"unit": "V", "name": "Grid TR/WU/CA line voltage", "key": "G_CA_L_V"},
                {"unit": "Hz", "name": "Grid Frequency", "key": "PG_F1"},
                {"unit": "W", "name": "Total Grid Power", "value": "0.00", "key": "PG_Pt1"},
                {"unit": "kWh", "name": "Cumulative Grid Feed-in", "key": "t_gc1"},
                {"unit": "kWh", "name": "Cumulative Energy Purchased", "key": "Et_pu1"},
                {"unit": "kWh", "name": "Daily Grid Feed-in", "key": "t_gc_tdy1"},
                {"unit": "kWh", "name": "Daily Energy Purchased", "key": "Etdy_pu1"},
                {"unit": "kWh", "name": "Monthly Grid Feed-in", "key": "t_gc_tdy2"},
                {"unit": "kWh", "name": "Monthly Energy Purchased", "key": "Etdy_pu2"},
                {"unit": "kWh", "name": "Yearly Grid Feed-in", "key": "t_gc_tdy3"},
                {"unit": "kWh", "name": "Yearly Energy Purchased", "key": "Etdy_pu3"},
                {"unit": "V", "name": "Combiner Voltage-Group 1", "value": "0.00", "key": "COM_VOL_GR_1"},
                {"unit": "A", "name": "String Current- Group 1 Line 1", "value": "0.00", "key": "STR_CUR__L1_GR_1"},
                {"unit": "A", "name": "String Current- Group 1 Line 2", "value": "0.47", "key": "STR_CUR__L2_GR_1"},
                {"unit": "V", "name": "Combiner Voltage-Group 2", "value": "0.00", "key": "COM_VOL_GR_2"},
                {"unit": "A", "name": "String Current- Group 1 Line 3", "key": "STR_C_G1_L3"},
                {"unit": "A", "name": "String Current- Group 1 Line 4", "key": "STR_C_G1_L4"},
                {"unit": "A", "name": "String Current- Group 2 Line 1", "value": "0.00", "key": "STR_CUR__L1_GR_2"},
                {"unit": "A", "name": "String Current- Group 2 Line 2", "value": "0.39", "key": "STR_CUR__L2_GR_2"},
                {"unit": "V", "name": "Combiner Voltage-Group 3", "value": "0.00", "key": "COM_VOL_GR_3"},
                {"unit": "A", "name": "String Current- Group 2 Line 3", "key": "STR_C_G2_L3"},
                {"unit": "A", "name": "String Current- Group 2 Line 4", "key": "STR_C_G2_L4"},
                {"unit": "A", "name": "String Current- Group 3 Line 1", "value": "0.00", "key": "STR_CUR__L1_GR_3"},
                {"unit": "A", "name": "String Current- Group 3 Line 2", "value": "0.75", "key": "STR_CUR__L2_GR_3"},
                {"unit": "V", "name": "Combiner Voltage-Group 4", "value": "0.00", "key": "COM_VOL_GR_4"},
                {"unit": "A", "name": "String Current- Group 3 Line 3", "key": "STR_C_G3_L3"},
                {"unit": "A", "name": "String Current- Group 3 Line 4", "key": "STR_C_G3_L4"},
                {"unit": "A", "name": "String Current- Group 4 Line 1", "value": "0.00", "key": "STR_CUR__L1_GR_4"},
                {"unit": "A", "name": "String Current- Group 4 Line 2", "value": "0.59", "key": "STR_CUR__L2_GR_4"},
                {"unit": "V", "name": "Combiner Voltage-Group 5", "value": "0.00", "key": "COM_VOL_GR_5"},
                {"unit": "A", "name": "String Current- Group 4 Line 3", "key": "STR_C_G4_L3"},
                {"unit": "A", "name": "String Current- Group 4 Line 4", "key": "STR_C_G4_L4"},
                {"unit": "A", "name": "String Current- Group 5 Line 1", "value": "0.00", "key": "STR_CUR__L1_GR_5"},
                {"unit": "A", "name": "String Current- String Current- Group 5 Line 2", "value": "0.14", "key": "STR_CUR__L2_GR_5"},
                {"unit": "V", "name": "Combiner Voltage-Group 6", "value": "0.00", "key": "COM_VOL_GR_6"},
                {"unit": "A", "name": "String Current- Group 5 Line 3", "key": "STR_C_G5_L3"},
                {"unit": "A", "name": "String Current- Group 6 Line 1", "value": "0.00", "key": "STR_CUR__L1_GR_6"},
                {"unit": "A", "name": "String Current- Group 5 Line 4", "key": "STR_C_G5_L4"},
                {"unit": "A", "name": "String Current- Group 6 Line 2", "value": "0.52", "key": "STR_CUR__L2_GR_6"},
                {"unit": "V", "name": "Combiner Voltage-Group 7", "key": "COM_VOL_GR_7"},
                {"unit": "A", "name": "String Current- Group 6 Line 3", "key": "STR_C_G6_L3"},
                {"unit": "A", "name": "String Current- Group 7 Line 1", "key": "STR_CUR__L1_GR_7"},
                {"unit": "A", "name": "String Current- Group 6 Line 4", "key": "STR_C_G6_L4"},
                {"unit": "A", "name": "String Current- Group 7 Line 2", "key": "STR_CUR__L2_GR_7"},
                {"unit": "V", "name": "Combiner Voltage-Group 8", "key": "COM_VOL_GR_8"},
                {"unit": "A", "name": "String Current- Group 7 Line 3", "key": "STR_C_G7_L3"},
                {"unit": "A", "name": "String Current- Group 8 Line 1", "key": "STR_CUR__L1_GR_8"},
                {"unit": "A", "name": "String Current- Group 8 Line 2", "key": "STR_CUR__L2_GR_8"}
            ]
        }
    ]
}

# Extract data from JSON
data_list = json_data["paramDataList"][0]["dataList"]
collect_time = json_data["paramDataList"][0]["collectTime"]
device_sn = json_data["deviceSn"]
device_id = json_data["deviceId"]
device_type = json_data["deviceType"]

# Prepare data for DataFrame
rows = []
for item in data_list:
    row = {
        "Collect Time": collect_time,
        "Device SN": device_sn,
        "Device ID": device_id,
        "Device Type": device_type,
        "Parameter Name": item["name"],
        "Key": item["key"],
        "Value": item.get("value", ""),
        "Unit": item.get("unit", "")
    }
    rows.append(row)

# Create DataFrame
df = pd.DataFrame(rows)

# Save to Excel
output_file = "inverter_data.xlsx"
df.to_excel(output_file, index=False, engine="openpyxl")

print(f"Excel file '{output_file}' has been created successfully.")